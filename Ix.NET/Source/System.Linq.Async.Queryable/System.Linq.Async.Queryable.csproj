<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <!--
    .NET 10.0 gets its own target because that doesn't need a transitive reference
    to System.Linq.AsyncEnumerable - it's built in from .NET 10.0 and later -
    but all other targets do need that reference.
    Even though we support back to .NET 8.0 for v7, we don't build targets for
    any versions older than net10.0 because net8.0 and net9.0 are both covered
    by the netstandard2.0 target.
    -->
    <TargetFrameworks>net48;netstandard2.0;netstandard2.1;net10.0</TargetFrameworks>
    <Title>System.Linq.Async.Queryable</Title>
    <PackageTags>LINQ;async;streams;query;provider</PackageTags>
    <Description>Provides support for Language-Integrated Query (LINQ) over IAsyncQueryable&lt;T&gt; sequences with query providers.</Description>
  </PropertyGroup>

  <ItemGroup>
    <ProjectReference Include="..\System.Linq.Async\System.Linq.Async.csproj" />
  </ItemGroup>

  <ItemGroup Condition="'$(TargetFramework)' != 'net10.0'">
    <!-- Although we get this transitively from System.Linq.Async, we need the alias to ensure we compile against the legacy System.Linq.Async -->
    <PackageReference Include="System.Linq.AsyncEnumerable" Version="10.0.0" Aliases="SystemLinqAsyncEnumerable" />
  </ItemGroup>
  <Target Name="_SetAliasOnBuiltInSystemLinqAsyncEnumerable" BeforeTargets="ResolveAssemblyReferences">

    <ItemGroup Condition="'$(TargetFramework)' == 'net10.0'">
      <Reference Condition="'%(Reference.AssemblyName)' == 'System.Linq.AsyncEnumerable'">
        <Aliases>SystemLinqAsyncEnumerable</Aliases>
      </Reference>
    </ItemGroup>
  </Target>

  <ItemGroup>
    <Compile Update="System\Linq\AsyncQueryable.Generated.cs">
      <DependentUpon>AsyncQueryable.Generated.tt</DependentUpon>
      <DesignTime>True</DesignTime>
      <AutoGen>True</AutoGen>
    </Compile>
  </ItemGroup>

  <ItemGroup>
    <None Update="System\Linq\AsyncQueryable.Generated.tt">
      <LastGenOutput>AsyncQueryable.Generated.cs</LastGenOutput>
      <Generator>TextTemplatingFileGenerator</Generator>
    </None>
  </ItemGroup>

  <ItemGroup>
    <!-- T4. -->
    <Service Include="{508349b6-6b84-4df5-91f0-309beebad82d}" />
  </ItemGroup>
</Project>
